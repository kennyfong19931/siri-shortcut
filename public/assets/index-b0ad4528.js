(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=e(r);fetch(r.href,i)}})();/*!
 * Color mode toggler for Bootstrap's docs (https://getbootstrap.com/)
 * Copyright 2011-2023 The Bootstrap Authors
 * Licensed under the Creative Commons Attribution 3.0 Unported License.
 */(()=>{const n=()=>localStorage.getItem("theme"),t=i=>localStorage.setItem("theme",i),e=()=>{const i=n();return i||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},o=i=>{i==="auto"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.setAttribute("data-bs-theme","dark"):document.documentElement.setAttribute("data-bs-theme",i)};o(e());const r=(i,a=!1)=>{const s=document.querySelector("#bd-theme");if(!s)return;const l=document.querySelector("#bd-theme-text"),c=document.querySelector(".theme-icon-active use"),d=document.querySelector(`[data-bs-theme-value="${i}"]`),f=d.querySelector("svg use").getAttribute("href");document.querySelectorAll("[data-bs-theme-value]").forEach(_=>{_.classList.remove("active"),_.setAttribute("aria-pressed","false")}),d.classList.add("active"),d.setAttribute("aria-pressed","true"),c.setAttribute("href",f);const m=`${l.textContent} (${d.dataset.bsThemeValue})`;s.setAttribute("aria-label",m),a&&s.focus()};window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{const i=n();i!=="light"&&i!=="dark"&&o(e())}),window.addEventListener("DOMContentLoaded",()=>{r(e()),document.querySelectorAll("[data-bs-theme-value]").forEach(i=>{i.addEventListener("click",()=>{const a=i.getAttribute("data-bs-theme-value");t(a),o(a),r(a,!0)})})})})();const it=new Map,le={set(n,t,e){it.has(n)||it.set(n,new Map);const o=it.get(n);if(!o.has(t)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(t,e)},get(n,t){return it.has(n)&&it.get(n).get(t)||null},remove(n,t){if(!it.has(n))return;const e=it.get(n);e.delete(t),e.size===0&&it.delete(n)}},ho=1e3,Se="transitionend",En=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(t,e)=>`#${CSS.escape(e)}`)),n),po=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),mo=n=>{if(!n)return 0;let{transitionDuration:t,transitionDelay:e}=window.getComputedStyle(n);const o=Number.parseFloat(t),r=Number.parseFloat(e);return!o&&!r?0:(t=t.split(",")[0],e=e.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(e))*ho)},go=n=>{n.dispatchEvent(new Event(Se))},wt=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),De=n=>wt(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(En(n)):null,Le=n=>{if(!wt(n)||n.getClientRects().length===0)return!1;const t=getComputedStyle(n).getPropertyValue("visibility")==="visible",e=n.closest("details:not([open])");if(!e)return t;if(e!==n){const o=n.closest("summary");if(o&&o.parentNode!==e||o===null)return!1}return t},Be=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",_n=n=>{n.offsetHeight},yn=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,ce=[],bo=n=>{document.readyState==="loading"?(ce.length||document.addEventListener("DOMContentLoaded",()=>{for(const t of ce)t()}),ce.push(n)):n()},ze=()=>document.documentElement.dir==="rtl",wn=n=>{bo(()=>{const t=yn();if(t){const e=n.NAME,o=t.fn[e];t.fn[e]=n.jQueryInterface,t.fn[e].Constructor=n,t.fn[e].noConflict=()=>(t.fn[e]=o,n.jQueryInterface)}})},gt=(n,t=[],e=n)=>typeof n=="function"?n(...t):e,Sn=(n,t,e=!0)=>{if(!e){gt(n);return}const o=5,r=mo(t)+o;let i=!1;const a=({target:s})=>{s===t&&(i=!0,t.removeEventListener(Se,a),gt(n))};t.addEventListener(Se,a),setTimeout(()=>{i||go(t)},r)},vo=/[^.]*(?=\..*)\.|.*/,Eo=/\..*/,_o=/::\d+$/,ue={};let Ke=1;const Dn={mouseenter:"mouseover",mouseleave:"mouseout"},yo=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function An(n,t){return t&&`${t}::${Ke++}`||n.uidEvent||Ke++}function Tn(n){const t=An(n);return n.uidEvent=t,ue[t]=ue[t]||{},ue[t]}function wo(n,t){return function e(o){return Pe(o,{delegateTarget:n}),e.oneOff&&E.off(n,o.type,t),t.apply(n,[o])}}function So(n,t,e){return function o(r){const i=n.querySelectorAll(t);for(let{target:a}=r;a&&a!==this;a=a.parentNode)for(const s of i)if(s===a)return Pe(r,{delegateTarget:a}),o.oneOff&&E.off(n,r.type,t,e),e.apply(a,[r])}}function kn(n,t,e=null){return Object.values(n).find(o=>o.callable===t&&o.delegationSelector===e)}function Cn(n,t,e){const o=typeof t=="string",r=o?e:t||e;let i=Nn(n);return yo.has(i)||(i=n),[o,r,i]}function Xe(n,t,e,o,r){if(typeof t!="string"||!n)return;let[i,a,s]=Cn(t,e,o);t in Dn&&(a=(v=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return v.call(this,b)})(a));const l=Tn(n),c=l[s]||(l[s]={}),d=kn(c,a,i?e:null);if(d){d.oneOff=d.oneOff&&r;return}const f=An(a,t.replace(vo,"")),m=i?So(n,e,a):wo(n,a);m.delegationSelector=i?e:null,m.callable=a,m.oneOff=r,m.uidEvent=f,c[f]=m,n.addEventListener(s,m,i)}function Ae(n,t,e,o,r){const i=kn(t[e],o,r);i&&(n.removeEventListener(e,i,!!r),delete t[e][i.uidEvent])}function Do(n,t,e,o){const r=t[e]||{};for(const[i,a]of Object.entries(r))i.includes(o)&&Ae(n,t,e,a.callable,a.delegationSelector)}function Nn(n){return n=n.replace(Eo,""),Dn[n]||n}const E={on(n,t,e,o){Xe(n,t,e,o,!1)},one(n,t,e,o){Xe(n,t,e,o,!0)},off(n,t,e,o){if(typeof t!="string"||!n)return;const[r,i,a]=Cn(t,e,o),s=a!==t,l=Tn(n),c=l[a]||{},d=t.startsWith(".");if(typeof i<"u"){if(!Object.keys(c).length)return;Ae(n,l,a,i,r?e:null);return}if(d)for(const f of Object.keys(l))Do(n,l,f,t.slice(1));for(const[f,m]of Object.entries(c)){const _=f.replace(_o,"");(!s||t.includes(_))&&Ae(n,l,a,m.callable,m.delegationSelector)}},trigger(n,t,e){if(typeof t!="string"||!n)return null;const o=yn(),r=Nn(t),i=t!==r;let a=null,s=!0,l=!0,c=!1;i&&o&&(a=o.Event(t,e),o(n).trigger(a),s=!a.isPropagationStopped(),l=!a.isImmediatePropagationStopped(),c=a.isDefaultPrevented());const d=Pe(new Event(t,{bubbles:s,cancelable:!0}),e);return c&&d.preventDefault(),l&&n.dispatchEvent(d),d.defaultPrevented&&a&&a.preventDefault(),d}};function Pe(n,t={}){for(const[e,o]of Object.entries(t))try{n[e]=o}catch{Object.defineProperty(n,e,{configurable:!0,get(){return o}})}return n}function qe(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function de(n){return n.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}const Bt={setDataAttribute(n,t,e){n.setAttribute(`data-bs-${de(t)}`,e)},removeDataAttribute(n,t){n.removeAttribute(`data-bs-${de(t)}`)},getDataAttributes(n){if(!n)return{};const t={},e=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of e){let r=o.replace(/^bs/,"");r=r.charAt(0).toLowerCase()+r.slice(1,r.length),t[r]=qe(n.dataset[o])}return t},getDataAttribute(n,t){return qe(n.getAttribute(`data-bs-${de(t)}`))}};class Me{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const o=wt(e)?Bt.getDataAttribute(e,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...wt(e)?Bt.getDataAttributes(e):{},...typeof t=="object"?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[o,r]of Object.entries(e)){const i=t[o],a=wt(i)?"element":po(i);if(!new RegExp(r).test(a))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${a}" but expected type "${r}".`)}}}const Ao="5.3.0";class On extends Me{constructor(t,e){super(),t=De(t),t&&(this._element=t,this._config=this._getConfig(e),le.set(this._element,this.constructor.DATA_KEY,this))}dispose(){le.remove(this._element,this.constructor.DATA_KEY),E.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,o=!0){Sn(t,e,o)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return le.get(De(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,typeof e=="object"?e:null)}static get VERSION(){return Ao}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const fe=n=>{let t=n.getAttribute("data-bs-target");if(!t||t==="#"){let e=n.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e=`#${e.split("#")[1]}`),t=e&&e!=="#"?e.trim():null}return En(t)},P={find(n,t=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(t,n))},findOne(n,t=document.documentElement){return Element.prototype.querySelector.call(t,n)},children(n,t){return[].concat(...n.children).filter(e=>e.matches(t))},parents(n,t){const e=[];let o=n.parentNode.closest(t);for(;o;)e.push(o),o=o.parentNode.closest(t);return e},prev(n,t){let e=n.previousElementSibling;for(;e;){if(e.matches(t))return[e];e=e.previousElementSibling}return[]},next(n,t){let e=n.nextElementSibling;for(;e;){if(e.matches(t))return[e];e=e.nextElementSibling}return[]},focusableChildren(n){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>`${e}:not([tabindex^="-"])`).join(",");return this.find(t,n).filter(e=>!Be(e)&&Le(e))},getSelectorFromElement(n){const t=fe(n);return t&&P.findOne(t)?t:null},getElementFromSelector(n){const t=fe(n);return t?P.findOne(t):null},getMultipleElementsFromSelector(n){const t=fe(n);return t?P.find(t):[]}},In="backdrop",To="fade",Ue="show",Je=`mousedown.bs.${In}`,ko={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Co={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Ln extends Me{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return ko}static get DefaultType(){return Co}static get NAME(){return In}show(t){if(!this._config.isVisible){gt(t);return}this._append();const e=this._getElement();this._config.isAnimated&&_n(e),e.classList.add(Ue),this._emulateAnimation(()=>{gt(t)})}hide(t){if(!this._config.isVisible){gt(t);return}this._getElement().classList.remove(Ue),this._emulateAnimation(()=>{this.dispose(),gt(t)})}dispose(){this._isAppended&&(E.off(this._element,Je),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add(To),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=De(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),E.on(t,Je,()=>{gt(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(t){Sn(t,this._getElement(),this._config.isAnimated)}}const Bn=(n,t="hide")=>{const e=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;E.on(document,e,`[data-bs-dismiss="${o}"]`,function(r){if(["A","AREA"].includes(this.tagName)&&r.preventDefault(),Be(this))return;const i=P.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(i)[t]()})},No="focustrap",Oo="bs.focustrap",te=`.${Oo}`,Io=`focusin${te}`,Lo=`keydown.tab${te}`,Bo="Tab",Po="forward",Qe="backward",Mo={autofocus:!0,trapElement:null},$o={autofocus:"boolean",trapElement:"element"};class Pn extends Me{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Mo}static get DefaultType(){return $o}static get NAME(){return No}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),E.off(document,te),E.on(document,Io,t=>this._handleFocusin(t)),E.on(document,Lo,t=>this._handleKeydown(t)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,E.off(document,te))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const o=P.focusableChildren(e);o.length===0?e.focus():this._lastTabNavDirection===Qe?o[o.length-1].focus():o[0].focus()}_handleKeydown(t){t.key===Bo&&(this._lastTabNavDirection=t.shiftKey?Qe:Po)}}const Ze=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",tn=".sticky-top",Vt="padding-right",en="margin-right";class Te{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Vt,e=>e+t),this._setElementAttributes(Ze,Vt,e=>e+t),this._setElementAttributes(tn,en,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Vt),this._resetElementAttributes(Ze,Vt),this._resetElementAttributes(tn,en)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,o){const r=this.getWidth(),i=a=>{if(a!==this._element&&window.innerWidth>a.clientWidth+r)return;this._saveInitialAttribute(a,e);const s=window.getComputedStyle(a).getPropertyValue(e);a.style.setProperty(e,`${o(Number.parseFloat(s))}px`)};this._applyManipulationCallback(t,i)}_saveInitialAttribute(t,e){const o=t.style.getPropertyValue(e);o&&Bt.setDataAttribute(t,e,o)}_resetElementAttributes(t,e){const o=r=>{const i=Bt.getDataAttribute(r,e);if(i===null){r.style.removeProperty(e);return}Bt.removeDataAttribute(r,e),r.style.setProperty(e,i)};this._applyManipulationCallback(t,o)}_applyManipulationCallback(t,e){if(wt(t)){e(t);return}for(const o of P.find(t,this._element))e(o)}}const xo="offcanvas",Ro="bs.offcanvas",et=`.${Ro}`,Mn=".data-api",Fo=`load${et}${Mn}`,Ho="Escape",nn="show",on="showing",rn="hiding",Yo="offcanvas-backdrop",$n=".offcanvas.show",Wo=`show${et}`,Vo=`shown${et}`,jo=`hide${et}`,an=`hidePrevented${et}`,xn=`hidden${et}`,Go=`resize${et}`,zo=`click${et}${Mn}`,Ko=`keydown.dismiss${et}`,Xo='[data-bs-toggle="offcanvas"]',qo={backdrop:!0,keyboard:!0,scroll:!1},Uo={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Z extends On{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return qo}static get DefaultType(){return Uo}static get NAME(){return xo}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||E.trigger(this._element,Wo,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Te().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(on);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(nn),this._element.classList.remove(on),E.trigger(this._element,Vo,{relatedTarget:t})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||E.trigger(this._element,jo).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(rn),this._backdrop.hide();const e=()=>{this._element.classList.remove(nn,rn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Te().reset(),E.trigger(this._element,xn)};this._queueCallback(e,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=()=>{if(this._config.backdrop==="static"){E.trigger(this._element,an);return}this.hide()},e=!!this._config.backdrop;return new Ln({className:Yo,isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?t:null})}_initializeFocusTrap(){return new Pn({trapElement:this._element})}_addEventListeners(){E.on(this._element,Ko,t=>{if(t.key===Ho){if(this._config.keyboard){this.hide();return}E.trigger(this._element,an)}})}static jQueryInterface(t){return this.each(function(){const e=Z.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}E.on(document,zo,Xo,function(n){const t=P.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Be(this))return;E.one(t,xn,()=>{Le(this)&&this.focus()});const e=P.findOne($n);e&&e!==t&&Z.getInstance(e).hide(),Z.getOrCreateInstance(t).toggle(this)});E.on(window,Fo,()=>{for(const n of P.find($n))Z.getOrCreateInstance(n).show()});E.on(window,Go,()=>{for(const n of P.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Z.getOrCreateInstance(n).hide()});Bn(Z);wn(Z);function $e(n){return window.btoa(encodeURIComponent(n))}function ae(n){return decodeURIComponent(window.atob(n))}function xe(n){return`/img/${n}.svg`}function Ft(n,t={}){let e=document.createElement("template"),o=document.querySelector(`template#${n}`).innerHTML;for(let r in t)o=o.replaceAll(r,t[r]);return e.innerHTML=o.trim(),e.content.firstChild}function ke(n,t=!1){switch(n){case"kmb":return t?"#FFFFFF":"#FF0000";case"ctb":return t?"#0080FF":"#F9BF00";case"nwfb":return t?"#7000CC":"#EF7925";case"nlb":return t?"#3DC9B4":"#2A897B";case"gmb":return t?"#53B776":"#337149";case"mtr":return t?"#53B776":"#1A81FF"}return"#000"}function Jo(){return Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)}const Qo="/api/route/{route}.json",Zo="/api/spatial/{path}.json",tr="/api/eta",er="/update.json",Rn=document.getElementById("searchAlert"),jt=document.getElementById("searchResult"),Fn=new Z("#searchDrawer"),nr="https://mapapi.geodata.gov.hk/gs/api/v1.0.0/xyz/basemap/wgs84/{z}/{x}/{y}.png",or="https://mapapi.geodata.gov.hk/gs/api/v1.0.0/xyz/imagery/wgs84/{z}/{x}/{y}.png",rr="https://mapapi.geodata.gov.hk/gs/api/v1.0.0/xyz/label/hk/tc/wgs84/{z}/{x}/{y}.png",Re='<a target="_blank" href="https://portal.csdi.gov.hk/">&copy; 地圖版權屬香港特區政府</a><img style="width:16px;height:16px;" src="https://api.hkmapservice.gov.hk/mapapi/landsdlogo.jpg" />',sn={delay:400,dashArray:[20,40],weight:5,paused:!1,reverse:!1,hardwareAccelerated:!0},Hn='<span class="loader m-3"></span>',Yn={className:"etaPopup",maxWidth:Jo()},ir=(n,t)=>{let e=`<div class="alert alert-${t}" role="alert"><div>${n}</div></div>`;Rn.innerHTML+=e},ar=()=>{Rn.innerHTML=""},sr=()=>{ar(),jt.innerHTML='<ul class="list-group placeholder-glow"><li class="list-group-item"><span class="placeholder col-12"></span></li><li class="list-group-item"><span class="placeholder col-12"></span></li></ul>';let n=document.getElementById("routeInput").value.toUpperCase();fetch(Qo.replace("{route}",n)).then(t=>t.json()).then(t=>{jt.innerHTML="",t.forEach((e,o)=>{let r=`<div class="d-flex align-items-center list-group-item list-group-item-action" id="route-${o}" onclick="renderRoute('route-${o}', '${$e(JSON.stringify(e))}')"><div class="flex-shrink-0"><img class="logo" src="${xe(e.company)}" alt="${e.company}"/></div><div class="flex-grow-1 ms-3">${e.orig}➡️${e.dest}</div></div>`;jt.innerHTML+=r})}).catch(function(t){console.log(t),ir(`Cannot find route ${n} !`,"danger"),jt.innerHTML=""})},lr=(n,t)=>{Array.from(document.getElementsByClassName("list-group-item")).forEach(function(a){a.classList.remove("active")}),document.getElementById(n).classList.add("active");const e=JSON.parse(ae(t));K.clearLayers(),e.stopList.forEach(a=>{const s={bookmarked:!1,company:e.company,route:e.route,routeId:e.routeId,routeType:e.routeType,routeDesc:`${e.orig}➡️${e.dest}`,dir:e.dir,stop:a.id,name:a.name,address:`${a.lat},${a.long}`,street:a.street,fare:a.fare,fareHoliday:a.fareHoliday};var l=L.marker([a.lat,a.long],s).addTo(ct);l.bindPopup(Hn,Yn),K.addLayer(l)});let o;const r=ke(e.company,!1),i=ke(e.company,!0);switch(e.company){case"kmb":o=`kmb/${e.route}/${e.dir}_${e.routeType}`;break;case"ctb":o=`ctb/${e.route}/${e.dir}`;break;case"nwfb":o=`nwfb/${e.route}/${e.dir}`;break;case"nlb":o=`nlb/${e.route}/${e.routeId}`;break;case"mtr":o=`mtr/${e.route}/${e.dir}`;break}fetch(Zo.replace("{path}",`${o}`)).then(a=>a.json()).then(a=>{let s=L.polyline.antPath(a,{color:r,pluseColor:i,...sn});K.addLayer(s)}).catch(function(a){let s=e.stopList.map(c=>[c.lat,c.long]);s=[s];let l=L.polyline.antPath(s,{color:r,pluseColor:i,...sn});K.addLayer(l)}),K.addTo(ct),ct.fitBounds(K.getBounds()),window.innerWidth<768&&Fn.hide()},cr=n=>{K.clearLayers();let t=n.target.closest("div.list-group-item");const e=JSON.parse(ae(t.dataset.routeJson)),o=e.address.split(","),r={bookmarked:!0,company:e.company,route:e.route,routeId:e.routeId,routeType:e.routeType,routeDesc:e.routeDesc,dir:e.dir,stop:e.stop,name:e.name,address:e.address,street:e.street,fare:e.fare,fareHoliday:e.fareHoliday};var i=L.marker(o,r).addTo(ct);i.bindPopup(Hn,Yn),K.addLayer(i),K.addTo(ct),ct.fitBounds(K.getBounds()),i.openPopup(),window.innerWidth<768&&Fn.hide()},ur=async n=>fetch(tr,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify([n])}).then(t=>t.json()).then(t=>t[0]).catch(t=>console.error(t)),dr=async n=>{var t=n.popup._source;const e=await ur(t.options).then(i=>i.map(a=>{let s="<li>";return a.eta!=null&&a.eta>-1&&(s+=a.eta+"分鐘"),a.remark&&(s+="("+a.remark+")"),s+="</li>",s}).join("")).catch(()=>"<li>未有資料</li>");let o=Ft("bookmarkBtn");if(!t.options.bookmarked){let i,a=document.querySelectorAll("div.list-group-item.group");a.length==0?(addGroup("預設群組"),i="預設群組"):i=a[0].dataset.groupName;const s={company:t.options.company,route:t.options.route,routeId:t.options.routeId,routeType:t.options.routeType,routeDesc:t.options.routeDesc,dir:t.options.dir,stop:t.options.stop,name:t.options.name,address:t.options.address,street:t.options.street,fare:t.options.fare,fareHoliday:t.options.fareHoliday};o=`<button class="btn btn-sm btn-outline-warning" onclick="addBookmark('${i}', '${$e(JSON.stringify(s))}', true)"><i id="bookmarkPopupIcon" class="bi bi-bookmark-plus" aria-label="收藏路線"></i></button>`}const r=Ft("etaPopup",{"{{companyLogo}}":xe(t.options.company),"{{routeNo}}":t.options.route,"{{title}}":t.options.name,"{{subtitle}}":t.options.routeDesc,"{{titlecss}}":`style="background-color: ${ke(t.options.company)}"`,"{{bookmarkBtn}}":o,"{{body}}":`<ul>${e}</ul>`});t._popup.setContent(r)};document.getElementById("btnSearch").onclick=sr;document.getElementById("routeInput").addEventListener("keypress",function(n){n.key==="Enter"&&(n.preventDefault(),document.getElementById("btnSearch").click())});var K=new L.FeatureGroup;const Wn=L.tileLayer(nr,{maxZoom:20,attribution:Re}),fr=L.tileLayer(or,{maxZoom:20,attribution:Re}),Vn=L.tileLayer(rr,{maxZoom:20,attribution:Re}),hr={地形圖:Wn,影像地圖:fr},pr={地名標籤:Vn},ct=L.map("map",{center:[22.322005998683245,114.17846497109828],zoom:13,layers:[Wn,Vn]});L.control.layers(hr,pr,{hideSingleBase:!0}).addTo(ct);ct.on("popupopen",dr);fetch(er).then(n=>n.json()).then(n=>{document.getElementById("getSiriShortcut").setAttribute("href",n.url),document.getElementById("siriShortcutVersion").innerHTML=`(v${n.version})`});window.renderRoute=lr;window.renderBookmarkStop=cr;const mr="modal",gr="bs.modal",Y=`.${gr}`,br=".data-api",vr="Escape",Er=`hide${Y}`,_r=`hidePrevented${Y}`,jn=`hidden${Y}`,Gn=`show${Y}`,yr=`shown${Y}`,wr=`resize${Y}`,Sr=`click.dismiss${Y}`,Dr=`mousedown.dismiss${Y}`,Ar=`keydown.dismiss${Y}`,Tr=`click${Y}${br}`,ln="modal-open",kr="fade",cn="show",he="modal-static",Cr=".modal.show",Nr=".modal-dialog",Or=".modal-body",Ir='[data-bs-toggle="modal"]',Lr={backdrop:!0,focus:!0,keyboard:!0},Br={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class bt extends On{constructor(t,e){super(t,e),this._dialog=P.findOne(Nr,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Te,this._addEventListeners()}static get Default(){return Lr}static get DefaultType(){return Br}static get NAME(){return mr}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||E.trigger(this._element,Gn,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(ln),this._adjustDialog(),this._backdrop.show(()=>this._showElement(t)))}hide(){!this._isShown||this._isTransitioning||E.trigger(this._element,Er).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(cn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){E.off(window,Y),E.off(this._dialog,Y),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Ln({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Pn({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=P.findOne(Or,this._dialog);e&&(e.scrollTop=0),_n(this._element),this._element.classList.add(cn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,E.trigger(this._element,yr,{relatedTarget:t})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){E.on(this._element,Ar,t=>{if(t.key===vr){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),E.on(window,wr,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),E.on(this._element,Dr,t=>{E.one(this._element,Sr,e=>{if(!(this._element!==t.target||this._element!==e.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(ln),this._resetAdjustments(),this._scrollBar.reset(),E.trigger(this._element,jn)})}_isAnimated(){return this._element.classList.contains(kr)}_triggerBackdropTransition(){if(E.trigger(this._element,_r).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(he)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(he),this._queueCallback(()=>{this._element.classList.remove(he),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),o=e>0;if(o&&!t){const r=ze()?"paddingLeft":"paddingRight";this._element.style[r]=`${e}px`}if(!o&&t){const r=ze()?"paddingRight":"paddingLeft";this._element.style[r]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each(function(){const o=bt.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof o[t]>"u")throw new TypeError(`No method named "${t}"`);o[t](e)}})}}E.on(document,Tr,Ir,function(n){const t=P.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),E.one(t,Gn,r=>{r.defaultPrevented||E.one(t,jn,()=>{Le(this)&&this.focus()})});const e=P.findOne(Cr);e&&bt.getInstance(e).hide(),bt.getOrCreateInstance(t).toggle(this)});Bn(bt);wn(bt);/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function un(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),e.push.apply(e,o)}return e}function q(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?un(Object(e),!0).forEach(function(o){Pr(n,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):un(Object(e)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(e,o))})}return n}function qt(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qt=function(t){return typeof t}:qt=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(n)}function Pr(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function tt(){return tt=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},tt.apply(this,arguments)}function Mr(n,t){if(n==null)return{};var e={},o=Object.keys(n),r,i;for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&(e[r]=n[r]);return e}function $r(n,t){if(n==null)return{};var e=Mr(n,t),o,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(r=0;r<i.length;r++)o=i[r],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(n,o)&&(e[o]=n[o])}return e}var xr="1.15.0";function Q(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var nt=Q(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ht=Q(/Edge/i),dn=Q(/firefox/i),Pt=Q(/safari/i)&&!Q(/chrome/i)&&!Q(/android/i),zn=Q(/iP(ad|od|hone)/i),Kn=Q(/chrome/i)&&Q(/android/i),Xn={capture:!1,passive:!1};function w(n,t,e){n.addEventListener(t,e,!nt&&Xn)}function y(n,t,e){n.removeEventListener(t,e,!nt&&Xn)}function ee(n,t){if(t){if(t[0]===">"&&(t=t.substring(1)),n)try{if(n.matches)return n.matches(t);if(n.msMatchesSelector)return n.msMatchesSelector(t);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(t)}catch{return!1}return!1}}function Rr(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function z(n,t,e,o){if(n){e=e||document;do{if(t!=null&&(t[0]===">"?n.parentNode===e&&ee(n,t):ee(n,t))||o&&n===e)return n;if(n===e)break}while(n=Rr(n))}return null}var fn=/\s+/g;function x(n,t,e){if(n&&t)if(n.classList)n.classList[e?"add":"remove"](t);else{var o=(" "+n.className+" ").replace(fn," ").replace(" "+t+" "," ");n.className=(o+(e?" "+t:"")).replace(fn," ")}}function p(n,t,e){var o=n&&n.style;if(o){if(e===void 0)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(e=n.currentStyle),t===void 0?e:e[t];!(t in o)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),o[t]=e+(typeof e=="string"?"":"px")}}function St(n,t){var e="";if(typeof n=="string")e=n;else do{var o=p(n,"transform");o&&o!=="none"&&(e=o+" "+e)}while(!t&&(n=n.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(e)}function qn(n,t,e){if(n){var o=n.getElementsByTagName(t),r=0,i=o.length;if(e)for(;r<i;r++)e(o[r],r);return o}return[]}function X(){var n=document.scrollingElement;return n||document.documentElement}function k(n,t,e,o,r){if(!(!n.getBoundingClientRect&&n!==window)){var i,a,s,l,c,d,f;if(n!==window&&n.parentNode&&n!==X()?(i=n.getBoundingClientRect(),a=i.top,s=i.left,l=i.bottom,c=i.right,d=i.height,f=i.width):(a=0,s=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,f=window.innerWidth),(t||e)&&n!==window&&(r=r||n.parentNode,!nt))do if(r&&r.getBoundingClientRect&&(p(r,"transform")!=="none"||e&&p(r,"position")!=="static")){var m=r.getBoundingClientRect();a-=m.top+parseInt(p(r,"border-top-width")),s-=m.left+parseInt(p(r,"border-left-width")),l=a+i.height,c=s+i.width;break}while(r=r.parentNode);if(o&&n!==window){var _=St(r||n),v=_&&_.a,b=_&&_.d;_&&(a/=b,s/=v,f/=v,d/=b,l=a+d,c=s+f)}return{top:a,left:s,bottom:l,right:c,width:f,height:d}}}function hn(n,t,e){for(var o=lt(n,!0),r=k(n)[t];o;){var i=k(o)[e],a=void 0;if(e==="top"||e==="left"?a=r>=i:a=r<=i,!a)return o;if(o===X())break;o=lt(o,!1)}return!1}function Dt(n,t,e,o){for(var r=0,i=0,a=n.children;i<a.length;){if(a[i].style.display!=="none"&&a[i]!==h.ghost&&(o||a[i]!==h.dragged)&&z(a[i],e.draggable,n,!1)){if(r===t)return a[i];r++}i++}return null}function Fe(n,t){for(var e=n.lastElementChild;e&&(e===h.ghost||p(e,"display")==="none"||t&&!ee(e,t));)e=e.previousElementSibling;return e||null}function H(n,t){var e=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==h.clone&&(!t||ee(n,t))&&e++;return e}function pn(n){var t=0,e=0,o=X();if(n)do{var r=St(n),i=r.a,a=r.d;t+=n.scrollLeft*i,e+=n.scrollTop*a}while(n!==o&&(n=n.parentNode));return[t,e]}function Fr(n,t){for(var e in n)if(n.hasOwnProperty(e)){for(var o in t)if(t.hasOwnProperty(o)&&t[o]===n[e][o])return Number(e)}return-1}function lt(n,t){if(!n||!n.getBoundingClientRect)return X();var e=n,o=!1;do if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var r=p(e);if(e.clientWidth<e.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||e.clientHeight<e.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!e.getBoundingClientRect||e===document.body)return X();if(o||t)return e;o=!0}}while(e=e.parentNode);return X()}function Hr(n,t){if(n&&t)for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function pe(n,t){return Math.round(n.top)===Math.round(t.top)&&Math.round(n.left)===Math.round(t.left)&&Math.round(n.height)===Math.round(t.height)&&Math.round(n.width)===Math.round(t.width)}var Mt;function Un(n,t){return function(){if(!Mt){var e=arguments,o=this;e.length===1?n.call(o,e[0]):n.apply(o,e),Mt=setTimeout(function(){Mt=void 0},t)}}}function Yr(){clearTimeout(Mt),Mt=void 0}function Jn(n,t,e){n.scrollLeft+=t,n.scrollTop+=e}function Qn(n){var t=window.Polymer,e=window.jQuery||window.Zepto;return t&&t.dom?t.dom(n).cloneNode(!0):e?e(n).clone(!0)[0]:n.cloneNode(!0)}var F="Sortable"+new Date().getTime();function Wr(){var n=[],t;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(r){if(!(p(r,"display")==="none"||r===h.ghost)){n.push({target:r,rect:k(r)});var i=q({},n[n.length-1].rect);if(r.thisAnimationDuration){var a=St(r,!0);a&&(i.top-=a.f,i.left-=a.e)}r.fromRect=i}})}},addAnimationState:function(o){n.push(o)},removeAnimationState:function(o){n.splice(Fr(n,{target:o}),1)},animateAll:function(o){var r=this;if(!this.options.animation){clearTimeout(t),typeof o=="function"&&o();return}var i=!1,a=0;n.forEach(function(s){var l=0,c=s.target,d=c.fromRect,f=k(c),m=c.prevFromRect,_=c.prevToRect,v=s.rect,b=St(c,!0);b&&(f.top-=b.f,f.left-=b.e),c.toRect=f,c.thisAnimationDuration&&pe(m,f)&&!pe(d,f)&&(v.top-f.top)/(v.left-f.left)===(d.top-f.top)/(d.left-f.left)&&(l=jr(v,m,_,r.options)),pe(f,d)||(c.prevFromRect=d,c.prevToRect=f,l||(l=r.options.animation),r.animate(c,v,f,l)),l&&(i=!0,a=Math.max(a,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(t),i?t=setTimeout(function(){typeof o=="function"&&o()},a):typeof o=="function"&&o(),n=[]},animate:function(o,r,i,a){if(a){p(o,"transition",""),p(o,"transform","");var s=St(this.el),l=s&&s.a,c=s&&s.d,d=(r.left-i.left)/(l||1),f=(r.top-i.top)/(c||1);o.animatingX=!!d,o.animatingY=!!f,p(o,"transform","translate3d("+d+"px,"+f+"px,0)"),this.forRepaintDummy=Vr(o),p(o,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),p(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){p(o,"transition",""),p(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},a)}}}}function Vr(n){return n.offsetWidth}function jr(n,t,e,o){return Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))/Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))*o.animation}var vt=[],me={initializeByDefault:!0},Yt={mount:function(t){for(var e in me)me.hasOwnProperty(e)&&!(e in t)&&(t[e]=me[e]);vt.forEach(function(o){if(o.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),vt.push(t)},pluginEvent:function(t,e,o){var r=this;this.eventCanceled=!1,o.cancel=function(){r.eventCanceled=!0};var i=t+"Global";vt.forEach(function(a){e[a.pluginName]&&(e[a.pluginName][i]&&e[a.pluginName][i](q({sortable:e},o)),e.options[a.pluginName]&&e[a.pluginName][t]&&e[a.pluginName][t](q({sortable:e},o)))})},initializePlugins:function(t,e,o,r){vt.forEach(function(s){var l=s.pluginName;if(!(!t.options[l]&&!s.initializeByDefault)){var c=new s(t,e,t.options);c.sortable=t,c.options=t.options,t[l]=c,tt(o,c.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var a=this.modifyOption(t,i,t.options[i]);typeof a<"u"&&(t.options[i]=a)}},getEventProperties:function(t,e){var o={};return vt.forEach(function(r){typeof r.eventProperties=="function"&&tt(o,r.eventProperties.call(e[r.pluginName],t))}),o},modifyOption:function(t,e,o){var r;return vt.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[e]=="function"&&(r=i.optionListeners[e].call(t[i.pluginName],o))}),r}};function Gr(n){var t=n.sortable,e=n.rootEl,o=n.name,r=n.targetEl,i=n.cloneEl,a=n.toEl,s=n.fromEl,l=n.oldIndex,c=n.newIndex,d=n.oldDraggableIndex,f=n.newDraggableIndex,m=n.originalEvent,_=n.putSortable,v=n.extraEventProperties;if(t=t||e&&e[F],!!t){var b,W=t.options,U="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!nt&&!Ht?b=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(b=document.createEvent("Event"),b.initEvent(o,!0,!0)),b.to=a||e,b.from=s||e,b.item=r||e,b.clone=i,b.oldIndex=l,b.newIndex=c,b.oldDraggableIndex=d,b.newDraggableIndex=f,b.originalEvent=m,b.pullMode=_?_.lastPutMode:void 0;var O=q(q({},v),Yt.getEventProperties(o,t));for(var V in O)b[V]=O[V];e&&e.dispatchEvent(b),W[U]&&W[U].call(t,b)}}var zr=["evt"],B=function(t,e){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=o.evt,i=$r(o,zr);Yt.pluginEvent.bind(h)(t,e,q({dragEl:u,parentEl:A,ghostEl:g,rootEl:S,nextEl:mt,lastDownEl:Ut,cloneEl:D,cloneHidden:st,dragStarted:Ot,putSortable:C,activeSortable:h.active,originalEvent:r,oldIndex:yt,oldDraggableIndex:$t,newIndex:R,newDraggableIndex:at,hideGhostForTarget:no,unhideGhostForTarget:oo,cloneNowHidden:function(){st=!0},cloneNowShown:function(){st=!1},dispatchSortableEvent:function(s){I({sortable:e,name:s,originalEvent:r})}},i))};function I(n){Gr(q({putSortable:C,cloneEl:D,targetEl:u,rootEl:S,oldIndex:yt,oldDraggableIndex:$t,newIndex:R,newDraggableIndex:at},n))}var u,A,g,S,mt,Ut,D,st,yt,R,$t,at,Gt,C,_t=!1,ne=!1,oe=[],ht,j,ge,be,mn,gn,Ot,Et,xt,Rt=!1,zt=!1,Jt,N,ve=[],Ce=!1,re=[],se=typeof document<"u",Kt=zn,bn=Ht||nt?"cssFloat":"float",Kr=se&&!Kn&&!zn&&"draggable"in document.createElement("div"),Zn=function(){if(se){if(nt)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),to=function(t,e){var o=p(t),r=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),i=Dt(t,0,e),a=Dt(t,1,e),s=i&&p(i),l=a&&p(a),c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+k(i).width,d=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+k(a).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&s.float&&s.float!=="none"){var f=s.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return i&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||c>=r&&o[bn]==="none"||a&&o[bn]==="none"&&c+d>r)?"vertical":"horizontal"},Xr=function(t,e,o){var r=o?t.left:t.top,i=o?t.right:t.bottom,a=o?t.width:t.height,s=o?e.left:e.top,l=o?e.right:e.bottom,c=o?e.width:e.height;return r===s||i===l||r+a/2===s+c/2},qr=function(t,e){var o;return oe.some(function(r){var i=r[F].options.emptyInsertThreshold;if(!(!i||Fe(r))){var a=k(r),s=t>=a.left-i&&t<=a.right+i,l=e>=a.top-i&&e<=a.bottom+i;if(s&&l)return o=r}}),o},eo=function(t){function e(i,a){return function(s,l,c,d){var f=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(i==null&&(a||f))return!0;if(i==null||i===!1)return!1;if(a&&i==="clone")return i;if(typeof i=="function")return e(i(s,l,c,d),a)(s,l,c,d);var m=(a?s:l).options.group.name;return i===!0||typeof i=="string"&&i===m||i.join&&i.indexOf(m)>-1}}var o={},r=t.group;(!r||qt(r)!="object")&&(r={name:r}),o.name=r.name,o.checkPull=e(r.pull,!0),o.checkPut=e(r.put),o.revertClone=r.revertClone,t.group=o},no=function(){!Zn&&g&&p(g,"display","none")},oo=function(){!Zn&&g&&p(g,"display","")};se&&!Kn&&document.addEventListener("click",function(n){if(ne)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),ne=!1,!1},!0);var pt=function(t){if(u){t=t.touches?t.touches[0]:t;var e=qr(t.clientX,t.clientY);if(e){var o={};for(var r in t)t.hasOwnProperty(r)&&(o[r]=t[r]);o.target=o.rootEl=e,o.preventDefault=void 0,o.stopPropagation=void 0,e[F]._onDragOver(o)}}},Ur=function(t){u&&u.parentNode[F]._isOutsideThisEl(t.target)};function h(n,t){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=t=tt({},t),n[F]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return to(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,s){a.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:h.supportPointer!==!1&&"PointerEvent"in window&&!Pt,emptyInsertThreshold:5};Yt.initializePlugins(this,n,e);for(var o in e)!(o in t)&&(t[o]=e[o]);eo(t);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=t.forceFallback?!1:Kr,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?w(n,"pointerdown",this._onTapStart):(w(n,"mousedown",this._onTapStart),w(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(w(n,"dragover",this),w(n,"dragenter",this)),oe.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),tt(this,Wr())}h.prototype={constructor:h,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Et=null)},_getDirection:function(t,e){return typeof this.options.direction=="function"?this.options.direction.call(this,t,e,u):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,o=this.el,r=this.options,i=r.preventOnFilter,a=t.type,s=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,l=(s||t).target,c=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,d=r.filter;if(ri(o),!u&&!(/mousedown|pointerdown/.test(a)&&t.button!==0||r.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Pt&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=z(l,r.draggable,o,!1),!(l&&l.animated)&&Ut!==l)){if(yt=H(l),$t=H(l,r.draggable),typeof d=="function"){if(d.call(this,t,l,this)){I({sortable:e,rootEl:c,name:"filter",targetEl:l,toEl:o,fromEl:o}),B("filter",e,{evt:t}),i&&t.cancelable&&t.preventDefault();return}}else if(d&&(d=d.split(",").some(function(f){if(f=z(c,f.trim(),o,!1),f)return I({sortable:e,rootEl:f,name:"filter",targetEl:l,fromEl:o,toEl:o}),B("filter",e,{evt:t}),!0}),d)){i&&t.cancelable&&t.preventDefault();return}r.handle&&!z(c,r.handle,o,!1)||this._prepareDragStart(t,s,l)}}},_prepareDragStart:function(t,e,o){var r=this,i=r.el,a=r.options,s=i.ownerDocument,l;if(o&&!u&&o.parentNode===i){var c=k(o);if(S=i,u=o,A=u.parentNode,mt=u.nextSibling,Ut=o,Gt=a.group,h.dragged=u,ht={target:u,clientX:(e||t).clientX,clientY:(e||t).clientY},mn=ht.clientX-c.left,gn=ht.clientY-c.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,u.style["will-change"]="all",l=function(){if(B("delayEnded",r,{evt:t}),h.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!dn&&r.nativeDraggable&&(u.draggable=!0),r._triggerDragStart(t,e),I({sortable:r,name:"choose",originalEvent:t}),x(u,a.chosenClass,!0)},a.ignore.split(",").forEach(function(d){qn(u,d.trim(),Ee)}),w(s,"dragover",pt),w(s,"mousemove",pt),w(s,"touchmove",pt),w(s,"mouseup",r._onDrop),w(s,"touchend",r._onDrop),w(s,"touchcancel",r._onDrop),dn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,u.draggable=!0),B("delayStart",this,{evt:t}),a.delay&&(!a.delayOnTouchOnly||e)&&(!this.nativeDraggable||!(Ht||nt))){if(h.eventCanceled){this._onDrop();return}w(s,"mouseup",r._disableDelayedDrag),w(s,"touchend",r._disableDelayedDrag),w(s,"touchcancel",r._disableDelayedDrag),w(s,"mousemove",r._delayedDragTouchMoveHandler),w(s,"touchmove",r._delayedDragTouchMoveHandler),a.supportPointer&&w(s,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){u&&Ee(u),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;y(t,"mouseup",this._disableDelayedDrag),y(t,"touchend",this._disableDelayedDrag),y(t,"touchcancel",this._disableDelayedDrag),y(t,"mousemove",this._delayedDragTouchMoveHandler),y(t,"touchmove",this._delayedDragTouchMoveHandler),y(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||t.pointerType=="touch"&&t,!this.nativeDraggable||e?this.options.supportPointer?w(document,"pointermove",this._onTouchMove):e?w(document,"touchmove",this._onTouchMove):w(document,"mousemove",this._onTouchMove):(w(u,"dragend",this),w(S,"dragstart",this._onDragStart));try{document.selection?Qt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,e){if(_t=!1,S&&u){B("dragStarted",this,{evt:e}),this.nativeDraggable&&w(document,"dragover",Ur);var o=this.options;!t&&x(u,o.dragClass,!1),x(u,o.ghostClass,!0),h.active=this,t&&this._appendGhost(),I({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(j){this._lastX=j.clientX,this._lastY=j.clientY,no();for(var t=document.elementFromPoint(j.clientX,j.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(j.clientX,j.clientY),t!==e);)e=t;if(u.parentNode[F]._isOutsideThisEl(t),e)do{if(e[F]){var o=void 0;if(o=e[F]._onDragOver({clientX:j.clientX,clientY:j.clientY,target:t,rootEl:e}),o&&!this.options.dragoverBubble)break}t=e}while(e=e.parentNode);oo()}},_onTouchMove:function(t){if(ht){var e=this.options,o=e.fallbackTolerance,r=e.fallbackOffset,i=t.touches?t.touches[0]:t,a=g&&St(g,!0),s=g&&a&&a.a,l=g&&a&&a.d,c=Kt&&N&&pn(N),d=(i.clientX-ht.clientX+r.x)/(s||1)+(c?c[0]-ve[0]:0)/(s||1),f=(i.clientY-ht.clientY+r.y)/(l||1)+(c?c[1]-ve[1]:0)/(l||1);if(!h.active&&!_t){if(o&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<o)return;this._onDragStart(t,!0)}if(g){a?(a.e+=d-(ge||0),a.f+=f-(be||0)):a={a:1,b:0,c:0,d:1,e:d,f};var m="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");p(g,"webkitTransform",m),p(g,"mozTransform",m),p(g,"msTransform",m),p(g,"transform",m),ge=d,be=f,j=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!g){var t=this.options.fallbackOnBody?document.body:S,e=k(u,!0,Kt,!0,t),o=this.options;if(Kt){for(N=t;p(N,"position")==="static"&&p(N,"transform")==="none"&&N!==document;)N=N.parentNode;N!==document.body&&N!==document.documentElement?(N===document&&(N=X()),e.top+=N.scrollTop,e.left+=N.scrollLeft):N=X(),ve=pn(N)}g=u.cloneNode(!0),x(g,o.ghostClass,!1),x(g,o.fallbackClass,!0),x(g,o.dragClass,!0),p(g,"transition",""),p(g,"transform",""),p(g,"box-sizing","border-box"),p(g,"margin",0),p(g,"top",e.top),p(g,"left",e.left),p(g,"width",e.width),p(g,"height",e.height),p(g,"opacity","0.8"),p(g,"position",Kt?"absolute":"fixed"),p(g,"zIndex","100000"),p(g,"pointerEvents","none"),h.ghost=g,t.appendChild(g),p(g,"transform-origin",mn/parseInt(g.style.width)*100+"% "+gn/parseInt(g.style.height)*100+"%")}},_onDragStart:function(t,e){var o=this,r=t.dataTransfer,i=o.options;if(B("dragStart",this,{evt:t}),h.eventCanceled){this._onDrop();return}B("setupClone",this),h.eventCanceled||(D=Qn(u),D.removeAttribute("id"),D.draggable=!1,D.style["will-change"]="",this._hideClone(),x(D,this.options.chosenClass,!1),h.clone=D),o.cloneId=Qt(function(){B("clone",o),!h.eventCanceled&&(o.options.removeCloneOnHide||S.insertBefore(D,u),o._hideClone(),I({sortable:o,name:"clone"}))}),!e&&x(u,i.dragClass,!0),e?(ne=!0,o._loopId=setInterval(o._emulateDragOver,50)):(y(document,"mouseup",o._onDrop),y(document,"touchend",o._onDrop),y(document,"touchcancel",o._onDrop),r&&(r.effectAllowed="move",i.setData&&i.setData.call(o,r,u)),w(document,"drop",o),p(u,"transform","translateZ(0)")),_t=!0,o._dragStartId=Qt(o._dragStarted.bind(o,e,t)),w(document,"selectstart",o),Ot=!0,Pt&&p(document.body,"user-select","none")},_onDragOver:function(t){var e=this.el,o=t.target,r,i,a,s=this.options,l=s.group,c=h.active,d=Gt===l,f=s.sort,m=C||c,_,v=this,b=!1;if(Ce)return;function W(Nt,uo){B(Nt,v,q({evt:t,isOwner:d,axis:_?"vertical":"horizontal",revert:a,dragRect:r,targetRect:i,canSort:f,fromSortable:m,target:o,completed:O,onMove:function(Ge,fo){return Xt(S,e,u,r,Ge,k(Ge),t,fo)},changed:V},uo))}function U(){W("dragOverAnimationCapture"),v.captureAnimationState(),v!==m&&m.captureAnimationState()}function O(Nt){return W("dragOverCompleted",{insertion:Nt}),Nt&&(d?c._hideClone():c._showClone(v),v!==m&&(x(u,C?C.options.ghostClass:c.options.ghostClass,!1),x(u,s.ghostClass,!0)),C!==v&&v!==h.active?C=v:v===h.active&&C&&(C=null),m===v&&(v._ignoreWhileAnimating=o),v.animateAll(function(){W("dragOverAnimationComplete"),v._ignoreWhileAnimating=null}),v!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(o===u&&!u.animated||o===e&&!o.animated)&&(Et=null),!s.dragoverBubble&&!t.rootEl&&o!==document&&(u.parentNode[F]._isOutsideThisEl(t.target),!Nt&&pt(t)),!s.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),b=!0}function V(){R=H(u),at=H(u,s.draggable),I({sortable:v,name:"change",toEl:e,newIndex:R,newDraggableIndex:at,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),o=z(o,s.draggable,e,!0),W("dragOver"),h.eventCanceled)return b;if(u.contains(t.target)||o.animated&&o.animatingX&&o.animatingY||v._ignoreWhileAnimating===o)return O(!1);if(ne=!1,c&&!s.disabled&&(d?f||(a=A!==S):C===this||(this.lastPutMode=Gt.checkPull(this,c,u,t))&&l.checkPut(this,c,u,t))){if(_=this._getDirection(t,o)==="vertical",r=k(u),W("dragOverValid"),h.eventCanceled)return b;if(a)return A=S,U(),this._hideClone(),W("revert"),h.eventCanceled||(mt?S.insertBefore(u,mt):S.appendChild(u)),O(!0);var M=Fe(e,s.draggable);if(!M||ti(t,_,this)&&!M.animated){if(M===u)return O(!1);if(M&&e===t.target&&(o=M),o&&(i=k(o)),Xt(S,e,u,r,o,i,t,!!o)!==!1)return U(),M&&M.nextSibling?e.insertBefore(u,M.nextSibling):e.appendChild(u),A=e,V(),O(!0)}else if(M&&Zr(t,_,this)){var ut=Dt(e,0,s,!0);if(ut===u)return O(!1);if(o=ut,i=k(o),Xt(S,e,u,r,o,i,t,!1)!==!1)return U(),e.insertBefore(u,ut),A=e,V(),O(!0)}else if(o.parentNode===e){i=k(o);var G=0,dt,At=u.parentNode!==e,$=!Xr(u.animated&&u.toRect||r,o.animated&&o.toRect||i,_),Tt=_?"top":"left",ot=hn(o,"top","top")||hn(u,"top","top"),kt=ot?ot.scrollTop:void 0;Et!==o&&(dt=i[Tt],Rt=!1,zt=!$&&s.invertSwap||At),G=ei(t,o,i,_,$?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,zt,Et===o);var J;if(G!==0){var ft=H(u);do ft-=G,J=A.children[ft];while(J&&(p(J,"display")==="none"||J===g))}if(G===0||J===o)return O(!1);Et=o,xt=G;var Ct=o.nextElementSibling,rt=!1;rt=G===1;var Wt=Xt(S,e,u,r,o,i,t,rt);if(Wt!==!1)return(Wt===1||Wt===-1)&&(rt=Wt===1),Ce=!0,setTimeout(Qr,30),U(),rt&&!Ct?e.appendChild(u):o.parentNode.insertBefore(u,rt?Ct:o),ot&&Jn(ot,0,kt-ot.scrollTop),A=u.parentNode,dt!==void 0&&!zt&&(Jt=Math.abs(dt-k(o)[Tt])),V(),O(!0)}if(e.contains(u))return O(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){y(document,"mousemove",this._onTouchMove),y(document,"touchmove",this._onTouchMove),y(document,"pointermove",this._onTouchMove),y(document,"dragover",pt),y(document,"mousemove",pt),y(document,"touchmove",pt)},_offUpEvents:function(){var t=this.el.ownerDocument;y(t,"mouseup",this._onDrop),y(t,"touchend",this._onDrop),y(t,"pointerup",this._onDrop),y(t,"touchcancel",this._onDrop),y(document,"selectstart",this)},_onDrop:function(t){var e=this.el,o=this.options;if(R=H(u),at=H(u,o.draggable),B("drop",this,{evt:t}),A=u&&u.parentNode,R=H(u),at=H(u,o.draggable),h.eventCanceled){this._nulling();return}_t=!1,zt=!1,Rt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ne(this.cloneId),Ne(this._dragStartId),this.nativeDraggable&&(y(document,"drop",this),y(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Pt&&p(document.body,"user-select",""),p(u,"transform",""),t&&(Ot&&(t.cancelable&&t.preventDefault(),!o.dropBubble&&t.stopPropagation()),g&&g.parentNode&&g.parentNode.removeChild(g),(S===A||C&&C.lastPutMode!=="clone")&&D&&D.parentNode&&D.parentNode.removeChild(D),u&&(this.nativeDraggable&&y(u,"dragend",this),Ee(u),u.style["will-change"]="",Ot&&!_t&&x(u,C?C.options.ghostClass:this.options.ghostClass,!1),x(u,this.options.chosenClass,!1),I({sortable:this,name:"unchoose",toEl:A,newIndex:null,newDraggableIndex:null,originalEvent:t}),S!==A?(R>=0&&(I({rootEl:A,name:"add",toEl:A,fromEl:S,originalEvent:t}),I({sortable:this,name:"remove",toEl:A,originalEvent:t}),I({rootEl:A,name:"sort",toEl:A,fromEl:S,originalEvent:t}),I({sortable:this,name:"sort",toEl:A,originalEvent:t})),C&&C.save()):R!==yt&&R>=0&&(I({sortable:this,name:"update",toEl:A,originalEvent:t}),I({sortable:this,name:"sort",toEl:A,originalEvent:t})),h.active&&((R==null||R===-1)&&(R=yt,at=$t),I({sortable:this,name:"end",toEl:A,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){B("nulling",this),S=u=A=g=mt=D=Ut=st=ht=j=Ot=R=at=yt=$t=Et=xt=C=Gt=h.dragged=h.ghost=h.clone=h.active=null,re.forEach(function(t){t.checked=!0}),re.length=ge=be=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":u&&(this._onDragOver(t),Jr(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],e,o=this.el.children,r=0,i=o.length,a=this.options;r<i;r++)e=o[r],z(e,a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||oi(e));return t},sort:function(t,e){var o={},r=this.el;this.toArray().forEach(function(i,a){var s=r.children[a];z(s,this.options.draggable,r,!1)&&(o[i]=s)},this),e&&this.captureAnimationState(),t.forEach(function(i){o[i]&&(r.removeChild(o[i]),r.appendChild(o[i]))}),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return z(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var o=this.options;if(e===void 0)return o[t];var r=Yt.modifyOption(this,t,e);typeof r<"u"?o[t]=r:o[t]=e,t==="group"&&eo(o)},destroy:function(){B("destroy",this);var t=this.el;t[F]=null,y(t,"mousedown",this._onTapStart),y(t,"touchstart",this._onTapStart),y(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(y(t,"dragover",this),y(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),oe.splice(oe.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!st){if(B("hideClone",this),h.eventCanceled)return;p(D,"display","none"),this.options.removeCloneOnHide&&D.parentNode&&D.parentNode.removeChild(D),st=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(st){if(B("showClone",this),h.eventCanceled)return;u.parentNode==S&&!this.options.group.revertClone?S.insertBefore(D,u):mt?S.insertBefore(D,mt):S.appendChild(D),this.options.group.revertClone&&this.animate(u,D),p(D,"display",""),st=!1}}};function Jr(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function Xt(n,t,e,o,r,i,a,s){var l,c=n[F],d=c.options.onMove,f;return window.CustomEvent&&!nt&&!Ht?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=t,l.from=n,l.dragged=e,l.draggedRect=o,l.related=r||t,l.relatedRect=i||k(t),l.willInsertAfter=s,l.originalEvent=a,n.dispatchEvent(l),d&&(f=d.call(c,l,a)),f}function Ee(n){n.draggable=!1}function Qr(){Ce=!1}function Zr(n,t,e){var o=k(Dt(e.el,0,e.options,!0)),r=10;return t?n.clientX<o.left-r||n.clientY<o.top&&n.clientX<o.right:n.clientY<o.top-r||n.clientY<o.bottom&&n.clientX<o.left}function ti(n,t,e){var o=k(Fe(e.el,e.options.draggable)),r=10;return t?n.clientX>o.right+r||n.clientX<=o.right&&n.clientY>o.bottom&&n.clientX>=o.left:n.clientX>o.right&&n.clientY>o.top||n.clientX<=o.right&&n.clientY>o.bottom+r}function ei(n,t,e,o,r,i,a,s){var l=o?n.clientY:n.clientX,c=o?e.height:e.width,d=o?e.top:e.left,f=o?e.bottom:e.right,m=!1;if(!a){if(s&&Jt<c*r){if(!Rt&&(xt===1?l>d+c*i/2:l<f-c*i/2)&&(Rt=!0),Rt)m=!0;else if(xt===1?l<d+Jt:l>f-Jt)return-xt}else if(l>d+c*(1-r)/2&&l<f-c*(1-r)/2)return ni(t)}return m=m||a,m&&(l<d+c*i/2||l>f-c*i/2)?l>d+c/2?1:-1:0}function ni(n){return H(u)<H(n)?1:-1}function oi(n){for(var t=n.tagName+n.className+n.src+n.href+n.textContent,e=t.length,o=0;e--;)o+=t.charCodeAt(e);return o.toString(36)}function ri(n){re.length=0;for(var t=n.getElementsByTagName("input"),e=t.length;e--;){var o=t[e];o.checked&&re.push(o)}}function Qt(n){return setTimeout(n,0)}function Ne(n){return clearTimeout(n)}se&&w(document,"touchmove",function(n){(h.active||_t)&&n.cancelable&&n.preventDefault()});h.utils={on:w,off:y,css:p,find:qn,is:function(t,e){return!!z(t,e,t,!1)},extend:Hr,throttle:Un,closest:z,toggleClass:x,clone:Qn,index:H,nextTick:Qt,cancelNextTick:Ne,detectDirection:to,getChild:Dt};h.get=function(n){return n[F]};h.mount=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];t[0].constructor===Array&&(t=t[0]),t.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(h.utils=q(q({},h.utils),o.utils)),Yt.mount(o)})};h.create=function(n,t){return new h(n,t)};h.version=xr;var T=[],It,Oe,Ie=!1,_e,ye,ie,Lt;function ii(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return n.prototype={dragStarted:function(e){var o=e.originalEvent;this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):this.options.supportPointer?w(document,"pointermove",this._handleFallbackAutoScroll):o.touches?w(document,"touchmove",this._handleFallbackAutoScroll):w(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var o=e.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?y(document,"dragover",this._handleAutoScroll):(y(document,"pointermove",this._handleFallbackAutoScroll),y(document,"touchmove",this._handleFallbackAutoScroll),y(document,"mousemove",this._handleFallbackAutoScroll)),vn(),Zt(),Yr()},nulling:function(){ie=Oe=It=Ie=Lt=_e=ye=null,T.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,o){var r=this,i=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,s=document.elementFromPoint(i,a);if(ie=e,o||this.options.forceAutoScrollFallback||Ht||nt||Pt){we(e,this.options,s,o);var l=lt(s,!0);Ie&&(!Lt||i!==_e||a!==ye)&&(Lt&&vn(),Lt=setInterval(function(){var c=lt(document.elementFromPoint(i,a),!0);c!==l&&(l=c,Zt()),we(e,r.options,c,o)},10),_e=i,ye=a)}else{if(!this.options.bubbleScroll||lt(s,!0)===X()){Zt();return}we(e,this.options,lt(s,!1),!1)}}},tt(n,{pluginName:"scroll",initializeByDefault:!0})}function Zt(){T.forEach(function(n){clearInterval(n.pid)}),T=[]}function vn(){clearInterval(Lt)}var we=Un(function(n,t,e,o){if(t.scroll){var r=(n.touches?n.touches[0]:n).clientX,i=(n.touches?n.touches[0]:n).clientY,a=t.scrollSensitivity,s=t.scrollSpeed,l=X(),c=!1,d;Oe!==e&&(Oe=e,Zt(),It=t.scroll,d=t.scrollFn,It===!0&&(It=lt(e,!0)));var f=0,m=It;do{var _=m,v=k(_),b=v.top,W=v.bottom,U=v.left,O=v.right,V=v.width,M=v.height,ut=void 0,G=void 0,dt=_.scrollWidth,At=_.scrollHeight,$=p(_),Tt=_.scrollLeft,ot=_.scrollTop;_===l?(ut=V<dt&&($.overflowX==="auto"||$.overflowX==="scroll"||$.overflowX==="visible"),G=M<At&&($.overflowY==="auto"||$.overflowY==="scroll"||$.overflowY==="visible")):(ut=V<dt&&($.overflowX==="auto"||$.overflowX==="scroll"),G=M<At&&($.overflowY==="auto"||$.overflowY==="scroll"));var kt=ut&&(Math.abs(O-r)<=a&&Tt+V<dt)-(Math.abs(U-r)<=a&&!!Tt),J=G&&(Math.abs(W-i)<=a&&ot+M<At)-(Math.abs(b-i)<=a&&!!ot);if(!T[f])for(var ft=0;ft<=f;ft++)T[ft]||(T[ft]={});(T[f].vx!=kt||T[f].vy!=J||T[f].el!==_)&&(T[f].el=_,T[f].vx=kt,T[f].vy=J,clearInterval(T[f].pid),(kt!=0||J!=0)&&(c=!0,T[f].pid=setInterval((function(){o&&this.layer===0&&h.active._onTouchMove(ie);var Ct=T[this.layer].vy?T[this.layer].vy*s:0,rt=T[this.layer].vx?T[this.layer].vx*s:0;typeof d=="function"&&d.call(h.dragged.parentNode[F],rt,Ct,n,ie,T[this.layer].el)!=="continue"||Jn(T[this.layer].el,rt,Ct)}).bind({layer:f}),24))),f++}while(t.bubbleScroll&&m!==l&&(m=lt(m,!1)));Ie=c}},30),ro=function(t){var e=t.originalEvent,o=t.putSortable,r=t.dragEl,i=t.activeSortable,a=t.dispatchSortableEvent,s=t.hideGhostForTarget,l=t.unhideGhostForTarget;if(e){var c=o||i;s();var d=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,f=document.elementFromPoint(d.clientX,d.clientY);l(),c&&!c.el.contains(f)&&(a("spill"),this.onSpill({dragEl:r,putSortable:o}))}};function He(){}He.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,o=t.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var r=Dt(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(e,r):this.sortable.el.appendChild(e),this.sortable.animateAll(),o&&o.animateAll()},drop:ro};tt(He,{pluginName:"revertOnSpill"});function Ye(){}Ye.prototype={onSpill:function(t){var e=t.dragEl,o=t.putSortable,r=o||this.sortable;r.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),r.animateAll()},drop:ro};tt(Ye,{pluginName:"removeOnSpill"});h.mount(new ii);h.mount(Ye,He);const io=document.getElementById("bookmarkList"),ao="##",so=`
`,ai=new bt("#addGroupModal"),We=n=>{n?([document.getElementById("btnBookmarkEdit"),document.getElementById("btnBookmarkDownload"),document.getElementById("btnBookmarkUpload")].forEach((t,e,o)=>{t.classList.add("d-none")}),[document.getElementById("btnBookmarkGroupAdd"),...document.getElementsByClassName("btnBookmarkGroupEdit"),document.getElementById("btnBookmarkSave"),document.getElementById("btnBookmarkReset"),...document.getElementsByClassName("btnBookmarkReorder"),...document.getElementsByClassName("btnBookmarkRemove")].forEach((t,e,o)=>{t.classList.remove("d-none")})):([document.getElementById("btnBookmarkEdit"),document.getElementById("btnBookmarkDownload"),document.getElementById("btnBookmarkUpload")].forEach((t,e,o)=>{t.classList.remove("d-none")}),[document.getElementById("btnBookmarkGroupAdd"),...document.getElementsByClassName("btnBookmarkGroupEdit"),document.getElementById("btnBookmarkSave"),document.getElementById("btnBookmarkReset"),...document.getElementsByClassName("btnBookmarkReorder"),...document.getElementsByClassName("btnBookmarkRemove")].forEach((t,e,o)=>{t.classList.add("d-none")}))},Ve=n=>{document.getElementById("groupNameInput").value.length>0&&(n=document.getElementById("groupNameInput").value,document.getElementById("groupNameInput").value="",ai.hide());const t=Ft("bookmarkGroup",{"{{name}}":n}),e=Ft("bookmarkRoute");t.appendChild(e),io.appendChild(t),new h(e,{handle:".btnBookmarkReorder",group:"route",animation:150})},si=n=>{n.target.closest("div.list-group-item.group").remove()},lo=(n,t,e=!1)=>{e&&(t=JSON.parse(ae(t)));const o=Ft("bookmarkRow",{"{{dataRouteJson}}":$e(JSON.stringify(t)),"{{companyLogo}}":xe(t.company),"{{route}}":t.route,"{{name}}":t.name,"{{routeDesc}}":t.routeDesc});document.querySelectorAll(`div[data-group-name="${n}"] .list-group.route`)[0].appendChild(o),e&&co()},li=n=>{n.target.closest("div.list-group-item").remove()},ci=()=>{We(!0)},co=()=>{We(!1);const n=[...document.getElementsByClassName("list-group-item")].map(t=>{const e=t.getAttribute("data-group-name");if(e){const o=[...t.querySelectorAll(".list-group-item")].map(r=>ae(r.getAttribute("data-route-json"))).join(ao);return JSON.stringify({[e]:o})}else return null}).filter(t=>!!t).join(so);localStorage.setItem("bookmarkList",n)},je=()=>{We(!1),io.innerHTML="";let n=[];localStorage.hasOwnProperty("bookmarkList")&&(n=localStorage.getItem("bookmarkList").split(so).map(t=>{const e=JSON.parse(t);return Object.entries(e).map(o=>({[o[0]]:o[1].split(ao).map(r=>JSON.parse(r))}))})),n.forEach(t=>{const e=Object.entries(t[0])[0];Ve(e[0]),e[1].forEach(o=>lo(e[0],o))})},ui=()=>{let n="";localStorage.hasOwnProperty("bookmarkList")&&(n=localStorage.getItem("bookmarkList"));let t=document.createElement("a"),e=new Blob([n],{type:"application/octet-stream"}),o=URL.createObjectURL(e);t.setAttribute("href",o),t.setAttribute("download","group"),t.click()},di=n=>{const t=new FileReader;t.onload=e=>{localStorage.setItem("bookmarkList",e.target.result),je()},t.onerror=e=>console.error(e),t.readAsText(n.target.files[0])};document.getElementById("btnBookmarkEdit").onclick=ci;document.getElementById("btnBookmarkSave").onclick=co;document.getElementById("btnBookmarkReset").onclick=je;document.getElementById("btnBookmarkGroupAddSubmit").onclick=Ve;document.getElementById("btnBookmarkDownload").onclick=ui;document.getElementById("fileUploadInput").addEventListener("change",di,!1);je();new h(document.getElementById("bookmarkList"),{handle:".btnBookmarkReorder",group:"group",animation:150});window.addGroup=Ve;window.removeGroup=si;window.addBookmark=lo;window.removeBookmark=li;
